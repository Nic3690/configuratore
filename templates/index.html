<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configuratore LED</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="container-fluid">
    <header class="row bg-light py-3 mb-4 align-items-center">
      <div class="col-md-3 text-start">
        <img src="{{ url_for('static', filename='img/logo-redo-nero.png') }}" alt="Logo Redo" class="site-logo">
        <span class="beta-tag">beta</span>
      </div>
      <div class="col-md-6 text-center">
        <h1 class="site-header-title mb-2">Configuratore Profili e Strip LED</h1>
        <p class="site-header-lead mb-0">Configura il tuo sistema di illuminazione lineare</p>
      </div>
      <div class="col-md-3"></div>
    </header>
    
    <!-- MODIFICA: Rimosso step 7 dalla barra di progresso -->
    <div class="step-progress mb-4">
      <div class="step-item active" id="progress-step1">
        <div class="step-number">1</div>
        <div class="step-title">Categoria</div>
      </div>
      <div class="step-item" id="progress-step2">
        <div class="step-number">2</div>
        <div class="step-title">Modello</div>
      </div>
      <div class="step-item" id="progress-step3">
        <div class="step-number">3</div>
        <div class="step-title">Potenza</div>
      </div>
      <div class="step-item" id="progress-step4">
        <div class="step-number">4</div>
        <div class="step-title">Alimentazione</div>
      </div>
      <div class="step-item" id="progress-step5">
        <div class="step-number">5</div>
        <div class="step-title">Dimmer/Cavi</div>
      </div>
      <div class="step-item" id="progress-step6">
        <div class="step-number">6</div>
        <div class="step-title">Riepilogo</div>
      </div>
    </div>
    
    <div class="step-section" id="step1-tipologia">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-4">Seleziona la tipologia del profilo</h2>
        </div>
      </div>
      
      <div class="row justify-content-center">
        <div class="col-12 col-lg-10">
          <div class="hotspot-container">
            <img src="/static/img/mappa.jpg" alt="Mappa dei LED" class="mappa-bg img-fluid">

            <div class="hotspots">
              <div class="hotspot" data-categoria="nanoprofili" style="top:70%; left:30%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="incasso" style="top:10%; left:70%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="sospensione" style="top:40%; left:15%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="plafone" style="top:10%; left:36%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="parete" style="top:70%; left:80%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="battiscopa" style="top:85%; left:80%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="scalino" style="top:65%; left:10%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="wall_washer" style="top:25%; left:90%;">
                <div class="hotspot-area"></div>
              </div>
              
              <div class="hotspot" data-categoria="particolari" style="top:55%; left:50%;">
                <div class="hotspot-area"></div>
              </div>
            </div>
            
            <div class="svg-lights-container">
              <img src="/static/img/svg/Parete.svg" alt="Luce parete" class="svg-light parete">
              <img src="/static/img/svg/Incasso.svg" alt="Luce incasso" class="svg-light incasso">
              <img src="/static/img/svg/Plafone.svg" alt="Luce plafone" class="svg-light plafone">
              <img src="/static/img/svg/Scalino.svg" alt="Luce scalino" class="svg-light scalino">
              <img src="/static/img/svg/Sospeso.svg" alt="Luce sospeso" class="svg-light sospeso">
              <img src="/static/img/svg/Battiscopa.svg" alt="Luce battiscopa" class="svg-light battiscopa">
              <img src="/static/img/svg/Nanoprofili.svg" alt="Luce nanoprofili" class="svg-light nanoprofili">
              <img src="/static/img/svg/Particolari.svg" alt="Luce particolari" class="svg-light particolari">
              <img src="/static/img/svg/Wall_Washer.svg" alt="Luce wall washer" class="svg-light wall_washer">
            </div>
          </div>

          <div class="text-center mt-5">
            <p class="small text-muted">Passa con il mouse sulle aree per visualizzare il tipo di illuminazione</p>
          </div>
        </div>
      </div>
    </div>
    
    <div class="step-section" id="step2-modello">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-4">Seleziona il modello del profilo</h2>
          <p class="text-center categoria-selezionata mb-4 fw-bold"></p>
        </div>
      </div>
      
      <div id="profili-container" class="container">
      </div>
      
      <div id="tipologia-container" class="container mt-4" style="display: none;">
        <h3 class="text-center mb-3">Seleziona la tipologia</h3>
        <div class="row justify-content-center" id="tipologie-options">
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <button class="btn btn-secondary btn-torna-indietro me-2">Torna alla selezione tipologia</button>
          <button class="btn btn-primary" id="btn-continua-step2" disabled>Continua</button>
        </div>
      </div>
    </div>

    <!-- MODIFICA: Spostato la sezione di personalizzazione qui - rinominata da step6 a step2-personalizzazione -->
    <div class="step-section" id="step2-personalizzazione">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Personalizzazione del profilo</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step2-personalizzazione">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step2-personalizzazione">Tipologia</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Personalizza la forma, la finitura e la lunghezza del tuo profilo</small>
          </p>
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Forma di taglio</h3>
        <div class="row" id="forma-taglio-container">
          <div class="col-md-4 mb-3">
            <div class="card option-card forma-taglio-card selected" data-forma="DRITTO_SEMPLICE">
              <div class="card-body text-center">
                <h5 class="card-title">Dritto semplice</h5>
                <img src="/static/img/dritto_semplice.png" alt="Dritto semplice" class="img-fluid mb-2" style="height: 60px;" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card forma-taglio-card" data-forma="FORMA_L_DX">
              <div class="card-body text-center">
                <h5 class="card-title">Forma a L DX</h5>
                <img src="/static/img/forma_a_l_dx.png" alt="Forma a L DX" class="img-fluid mb-2" style="height: 60px;" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card forma-taglio-card" data-forma="FORMA_L_SX">
              <div class="card-body text-center">
                <h5 class="card-title">Forma a L SX</h5>
                <img src="/static/img/forma_a_l_sx.png" alt="Forma a L SX" class="img-fluid mb-2" style="height: 60px;" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card forma-taglio-card" data-forma="FORMA_C">
              <div class="card-body text-center">
                <h5 class="card-title">Forma a C</h5>
                <img src="/static/img/forma_a_c.png" alt="Forma a C" class="img-fluid mb-2" style="height: 60px;" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card forma-taglio-card" data-forma="RETTANGOLO_QUADRATO">
              <div class="card-body text-center">
                <h5 class="card-title">Rettangolo/Quadrato</h5>
                <img src="/static/img/forma_a_rettangolo.png" alt="Rettangolo/Quadrato" class="img-fluid mb-2" style="height: 60px;" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Finitura</h3>
        <div class="row" id="finitura-container">
          <div class="col-md-3 mb-3">
            <div class="card option-card finitura-card" data-finitura="ALLUMINIO_ANODIZZATO">
              <div class="card-body text-center">
                <h5 class="card-title">Alluminio anodizzato</h5>
                <div class="finitura-preview alluminio-anodizzato mb-2"></div>
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card finitura-card" data-finitura="BIANCO">
              <div class="card-body text-center">
                <h5 class="card-title">Bianco</h5>
                <div class="finitura-preview bianco mb-2"></div>
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card finitura-card" data-finitura="NERO">
              <div class="card-body text-center">
                <h5 class="card-title">Nero</h5>
                <div class="finitura-preview nero mb-2"></div>
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card finitura-card" data-finitura="ALLUMINIO">
              <div class="card-body text-center">
                <h5 class="card-title">Alluminio</h5>
                <div class="finitura-preview alluminio mb-2"></div>
              </div>
            </div>
          </div>
        </div>
        
        <style>
          .finitura-preview {
            width: 100%;
            height: 40px;
            border-radius: 5px;
            border: 1px solid #ddd;
          }
          .alluminio-anodizzato {
            background: linear-gradient(135deg, #e1e1e1 0%, #b3b3b3 50%, #e1e1e1 100%);
          }
          .bianco {
            background-color: #ffffff;
          }
          .nero {
            background-color: #000000;
          }
          .alluminio {
            background: linear-gradient(135deg, #f5f5f5 0%, #c4c4c4 50%, #f5f5f5 100%);
          }
        </style>
      </div>
      
      <!-- Modifiche da apportare al file templates/index.html -->
      <!-- Sostituire la sezione di personalizzazione lunghezza con questa versione aggiornata -->

      <div class="container mb-5">
        <h3 class="mb-3">Personalizzazione lunghezza</h3>
        
        <div id="istruzioni-misurazione" class="mb-4">
          <!-- Qui verranno inserite le istruzioni specifiche per ogni forma -->
        </div>
        
        <div id="misurazione-container">
          <!-- Qui verranno inseriti i campi di misurazione in base alla forma selezionata -->
          <div class="form-group mb-4 lunghezza-personalizzata-container">
            <label for="lunghezza-personalizzata">Lunghezza richiesta (mm):</label>
            <input type="number" class="form-control" id="lunghezza-personalizzata" placeholder="Inserisci la lunghezza in millimetri" min="100">
            <div class="form-text text-muted">
              Nota: verrà aggiunto automaticamente uno spazio di 5mm per i tappi e la saldatura.
            </div>
          </div>
        </div>
        
        <!-- L'avviso di non assemblaggio verrà inserito qui dinamicamente quando necessario -->
        
        <div id="proposte-container" class="alert alert-info" style="display: none;">
          <h5>Proposte di lunghezza standard</h5>
          <p>Il sistema ha calcolato delle proposte di lunghezza standard più adatte per la tua installazione.</p>
          <p><strong style="color:#ff0000;">ATTENZIONE:</strong> se viene utilizzata la lunghezza personalizzata si verificherà uno spazio buio di <span id="spazio-produzione">5</span>mm.</p>
          
          <div class="row mt-3">
            <div class="col-md-6 mb-2">
              <div class="card">
                <div class="card-body text-center">
                  <h5 class="card-title">Proposta 1</h5>
                  <p class="card-text"><span id="proposta1-valore">1771mm</span></p>
                  <button class="btn btn-sm btn-outline-primary btn-seleziona-proposta" data-proposta="1" data-valore="1771">Seleziona</button>
                </div>
              </div>
            </div>
            
            <div class="col-md-6 mb-2">
              <div class="card">
                <div class="card-body text-center">
                  <h5 class="card-title">Proposta 2</h5>
                  <p class="card-text"><span id="proposta2-valore">1804mm</span></p>
                  <button class="btn btn-sm btn-outline-primary btn-seleziona-proposta" data-proposta="2" data-valore="1804">Seleziona</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- MODIFICA: Modificati i pulsanti per il flusso aggiornato -->
      <div class="row mt-4">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-step2-modello">Indietro</button>
          <button class="btn btn-success ms-2" id="btn-continua-personalizzazione" disabled>Continua</button>
        </div>
      </div>
    </div>

    <div class="step-section" id="step2-option-strip">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-4">Vuoi includere una strip LED?</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step2-option">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step2-option">Tipologia</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Scegli se configurare il profilo con o senza illuminazione LED</small>
          </p>
        </div>
      </div>
      
      <div class="container mb-5">
        <div class="row" id="strip-option-container">
          <div class="col-md-6 mb-3">
            <div class="card option-card strip-option-card" data-option="si">
              <div class="card-body text-center">
                <h5 class="card-title">Sì, con strip LED</h5>
                <p class="card-text small text-muted">Configura il profilo con illuminazione LED</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <div class="card option-card strip-option-card" data-option="no">
              <div class="card-body text-center">
                <h5 class="card-title">No, senza strip LED</h5>
                <p class="card-text small text-muted">Configura solo il profilo senza illuminazione</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <!-- MODIFICA: L'indietro ora torna alla personalizzazione invece che al modello -->
          <button class="btn btn-secondary" id="btn-torna-step2-personalizzazione">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-step2-option" disabled>Continua</button>
        </div>
      </div>
    </div>
    
    <!-- Nuova sezione da aggiungere in templates/index.html -->
    <!-- Inserire questa sezione dopo step2-option-strip e prima di step2-parametri -->

    <div class="step-section" id="step2-tipologia-strip">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Seleziona la tipologia di strip LED</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step2-tipologia-strip">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step2-tipologia-strip">Tipologia</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Seleziona prima la tipologia di strip LED da utilizzare</small>
          </p>
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Tipologia Strip LED</h3>
        <div class="row" id="tipologia-strip-container">
          <div class="col-md-4 mb-3">
            <div class="card option-card tipologia-strip-card" data-tipologia-strip="COB">
              <div class="card-body text-center">
                <h5 class="card-title">COB</h5>
                <p class="card-text small text-muted">Strip LED con tecnologia Chip On Board</p>
                <img src="/static/img/strip-cob.jpg" alt="Strip COB" class="img-fluid mb-2" style="height: 80px;" onerror="this.style.display='none'">
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card tipologia-strip-card" data-tipologia-strip="SMD">
              <div class="card-body text-center">
                <h5 class="card-title">SMD</h5>
                <p class="card-text small text-muted">Strip LED con tecnologia Surface Mount Device</p>
                <img src="/static/img/strip-smd.jpg" alt="Strip SMD" class="img-fluid mb-2" style="height: 80px;" onerror="this.style.display='none'">
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card tipologia-strip-card" data-tipologia-strip="SPECIAL">
              <div class="card-body text-center">
                <h5 class="card-title">SPECIAL STRIP</h5>
                <p class="card-text small text-muted">Strip LED con caratteristiche speciali</p>
                <img src="/static/img/strip-special.jpg" alt="Special Strip" class="img-fluid mb-2" style="height: 80px;" onerror="this.style.display='none'">
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Sottomenu per Special Strip, inizialmente nascosto -->
      <div class="container mb-5" id="special-strip-container" style="display: none;">
        <h3 class="mb-3">Tipo di Special Strip</h3>
        <div class="row" id="special-strip-options">
          <div class="col-md-4 mb-3">
            <div class="card option-card special-strip-card" data-special-strip="XFLEX">
              <div class="card-body text-center">
                <h5 class="card-title">XFLEX</h5>
                <p class="card-text small text-muted">Strip LED flessibile</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card special-strip-card" data-special-strip="RUNNING">
              <div class="card-body text-center">
                <h5 class="card-title">RUNNING</h5>
                <p class="card-text small text-muted">Strip LED con effetto di movimento</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card special-strip-card" data-special-strip="ZIG_ZAG">
              <div class="card-body text-center">
                <h5 class="card-title">ZIG ZAG</h5>
                <p class="card-text small text-muted">Strip LED con configurazione a zig zag</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card special-strip-card" data-special-strip="XNAKE">
              <div class="card-body text-center">
                <h5 class="card-title">XNAKE</h5>
                <p class="card-text small text-muted">Strip LED con design a serpente</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-4 mb-3">
            <div class="card option-card special-strip-card" data-special-strip="XMAGIS">
              <div class="card-body text-center">
                <h5 class="card-title">XMAGIS</h5>
                <p class="card-text small text-muted">Strip LED premium</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-step2-option-strip">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-tipologia-strip" disabled>Continua</button>
        </div>
      </div>
    </div>

    <div class="step-section" id="step2-parametri">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Scegli i parametri della strip LED</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step2-parametri">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step2-parametri">Tipologia</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Seleziona tensione, grado di protezione IP e temperatura colore per la tua strip LED</small>
          </p>
        </div>
      </div>
      
      <div class="container mb-4">
        <h3 class="mb-3">Tensione</h3>
        <div class="row" id="tensione-options">
          <div class="text-center">
            <div class="spinner-border" role="status"></div>
            <p>Caricamento opzioni tensione...</p>
          </div>
        </div>
      </div>
      
      <div class="container mb-4">
        <h3 class="mb-3">Grado di protezione IP</h3>
        <div class="row" id="ip-options">
        </div>
      </div>
      
      <div class="container mb-4">
        <h3 class="mb-3">Temperatura colore</h3>
        <div class="row" id="temperatura-iniziale-options">
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-step2-parametri">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-parametri" disabled>Continua</button>
        </div>
      </div>
    </div>
    
    <div class="step-section" id="step2-strip">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Seleziona la strip LED</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step2-strip">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step2-strip">Tipologia</span></span>
            <span class="badge bg-info selection-badge">Tensione: <span id="tensione-nome-step2-strip">Tensione</span></span>
            <span class="badge bg-warning selection-badge">IP: <span id="ip-nome-step2-strip">IP</span></span>
            <span class="badge bg-secondary selection-badge">Temperatura: <span id="temperatura-nome-step2-strip">Temperatura</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Seleziona la strip LED in base ai parametri scelti</small>
          </p>
        </div>
      </div>
      
      <div class="container mb-5">
        <div class="row" id="strip-led-filtrate-options">
          <div class="col-12 text-center">
            <div class="spinner-border" role="status"></div>
            <p class="mt-3">Caricamento opzioni strip LED...</p>
          </div>
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-parametri-strip">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-strip" disabled>Continua</button>
        </div>
      </div>
    </div>
    
    <div class="step-section" id="step3-temperatura-potenza">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Configura l'illuminazione</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step3">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step3">Tipologia</span></span>
            <span class="badge bg-info selection-badge">Strip LED: <span id="strip-nome-step3">Strip LED</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Seleziona la potenza desiderata per la tua strip LED</small>
          </p>
        </div>
      </div>
      
      <div class="container">
        <h3 class="mb-3">Potenza strip LED</h3>
        <div class="row" id="potenza-container">
        </div>
      </div>
      
      <div class="row mt-5">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-step2">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-step3" disabled>Continua</button>
        </div>
      </div>
    </div>

    <div class="step-section" id="step4-alimentazione">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Configura l'alimentazione</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step4">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step4">Tipologia</span></span>
            <span class="badge bg-info selection-badge">Strip LED: <span id="strip-nome-step4">Strip LED</span></span>
            <span class="badge bg-secondary selection-badge" id="badge-potenza-step4">Potenza: <span id="potenza-nome-step4">Potenza</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Seleziona l'alimentazione per il tuo sistema</small>
          </p>
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Alimentazione</h3>
        <div class="row" id="alimentazione-container">
          <div class="col-md-3 mb-3">
            <div class="card option-card alimentazione-card" data-alimentazione="ON-OFF">
              <div class="card-body text-center">
                <h5 class="card-title">ON/OFF</h5>
                <p class="card-text small text-muted">Alimentazione standard ON/OFF</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card alimentazione-card" data-alimentazione="DIMMERABILE_TRIAC">
              <div class="card-body text-center">
                <h5 class="card-title">Dimmerabile TRIAC</h5>
                <p class="card-text small text-muted">Alimentazione con controllo dell'intensità luminosa TRIAC</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card alimentazione-card" data-alimentazione="DIMMERABILE_DALI_PUSH">
              <div class="card-body text-center">
                <h5 class="card-title">Dimmerabile DALI/PUSH</h5>
                <p class="card-text small text-muted">Alimentazione con protocollo DALI o pulsante PUSH</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card alimentazione-card" data-alimentazione="SENZA_ALIMENTATORE">
              <div class="card-body text-center">
                <h5 class="card-title">Senza alimentatore</h5>
                <p class="card-text small text-muted">Configurazione senza alimentatore incluso</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="container" id="alimentatore-section" style="display: none;">
        <h3 class="mb-3">Tipologia Alimentatore</h3>
        <div class="row" id="alimentatore-container">
        </div>
      </div>

      <div class="container mt-4" id="potenza-consigliata-section" style="display: none;">
        <div class="alert alert-info">
          <h5>Potenza alimentatore consigliata</h5>
          <p>In base alla configurazione selezionata, la potenza consigliata per l'alimentatore è di <strong><span id="potenza-consigliata">100</span>W</strong>.</p>
        </div>
      </div>

      <div class="row mt-5">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-step3">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-step4" disabled>Continua</button>
        </div>
      </div>
    </div>

    <div class="step-section" id="step5-controllo">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Configura controllo e cablaggio</h2>
          
          <div class="selection-badges">
            <span class="badge bg-primary selection-badge">Modello: <span id="profilo-nome-step5">Profilo</span></span>
            <span class="badge bg-success selection-badge">Tipologia: <span id="tipologia-nome-step5">Tipologia</span></span>
            <span class="badge bg-info selection-badge">Strip LED: <span id="strip-nome-step5">Strip LED</span></span>
            <span class="badge bg-dark selection-badge">Alimentazione: <span id="alimentazione-nome-step5">Alimentazione</span></span>
          </div>
          
          <p class="text-center mb-4 text-muted">
            <small>Configura le opzioni di controllo e cablaggio del tuo sistema</small>
          </p>
        </div>
      </div>

      <div class="container mb-5">
        <div id="dimmer-container">
          <div class="text-center" id="dimmer-loading">
            <div class="spinner-border" role="status"></div>
            <p class="mt-3">Caricamento opzioni dimmer compatibili...</p>
          </div>
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Alimentazione Cavo</h3>
        <div class="row" id="alimentazione-cavo-container">
          <div class="col-md-6 mb-3">
            <div class="card option-card alimentazione-cavo-card" data-alimentazione-cavo="ALIMENTAZIONE_UNICA">
              <div class="card-body text-center">
                <h5 class="card-title">Alimentazione unica</h5>
                <p class="card-text small text-muted">Singolo punto di alimentazione</p>
              </div>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <div class="card option-card alimentazione-cavo-card" data-alimentazione-cavo="ALIMENTAZIONE_DOPPIA">
              <div class="card-body text-center">
                <h5 class="card-title">Alimentazione doppia</h5>
                <p class="card-text small text-muted">Due punti di alimentazione</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Lunghezza Cavo</h3>
        <div class="form-group mb-3">
          <label for="lunghezza-cavo-ingresso">Lunghezza cavo in ingresso (mm):</label>
          <input type="number" class="form-control" id="lunghezza-cavo-ingresso" value="1800" min="0">
        </div>
        
        <div id="lunghezza-cavo-uscita-container" class="form-group mb-3" style="display: none;">
          <label for="lunghezza-cavo-uscita">Lunghezza cavo in uscita (mm):</label>
          <input type="number" class="form-control" id="lunghezza-cavo-uscita" value="1800" min="0">
        </div>
      </div>
      
      <div class="container mb-5">
        <h3 class="mb-3">Uscita Cavo</h3>
        <div class="row" id="uscita-cavo-container">
          <div class="col-md-3 mb-3">
            <div class="card option-card uscita-cavo-card" data-uscita-cavo="DRITTA">
              <div class="card-body text-center">
                <h5 class="card-title">Dritta</h5>
                <img src="/static/img/uscita_dritta.png" alt="Uscita dritta" class="img-fluid mb-2" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card uscita-cavo-card" data-uscita-cavo="LATERALE_DX">
              <div class="card-body text-center">
                <h5 class="card-title">Laterale DX</h5>
                <img src="/static/img/uscita_laterale_dx.png" alt="Uscita laterale destra" class="img-fluid mb-2" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card uscita-cavo-card" data-uscita-cavo="RETRO">
              <div class="card-body text-center">
                <h5 class="card-title">Retro</h5>
                <img src="/static/img/uscita_retro.png" alt="Uscita retro" class="img-fluid mb-2" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
          
          <div class="col-md-3 mb-3">
            <div class="card option-card uscita-cavo-card" data-uscita-cavo="LATERALE_SX">
              <div class="card-body text-center">
                <h5 class="card-title">Laterale SX</h5>
                <img src="/static/img/uscita_laterale_sx.png" alt="Uscita laterale sinistra" class="img-fluid mb-2" onerror="this.src='/static/img/placeholder.jpg'; this.style.height='60px'">
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <button class="btn btn-secondary" id="btn-torna-step4">Indietro</button>
          <button class="btn btn-primary ms-2" id="btn-continua-step5" disabled>Continua</button>
        </div>
      </div>
    </div>

    <!-- MODIFICA: Rinominato da step7-riepilogo a step6-riepilogo -->
    <div class="step-section" id="step6-riepilogo">
      <div class="row">
        <div class="col-12">
          <h2 class="text-center mb-3">Riepilogo configurazione</h2>
          <p class="text-center mb-4 text-muted">
            <small>Di seguito il riepilogo delle opzioni selezionate per il tuo sistema di illuminazione</small>
          </p>
        </div>
      </div>
      
      <div id="riepilogo-container">
      </div>
      
      <div class="row mt-4">
        <div class="col-12 text-center">
          <!-- MODIFICA: Ora torna allo step 5 invece dello step 6 -->
          <button class="btn btn-secondary" id="btn-torna-step5">Modifica configurazione</button>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>